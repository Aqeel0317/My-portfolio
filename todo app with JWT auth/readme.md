
### Task Manager API

This is a **Task Manager API** built with FastAPI, designed to help users manage their personal tasks. It features user authentication, a RESTful API for task management, and automated email notifications for task creation and completion. The application uses SQLAlchemy for database interactions and a lightweight SQLite database for persistent storage.

#### Features

  * **User Management**: Secure user registration and login using JWT (JSON Web Tokens) for authentication. Passwords are **hashed** with `bcrypt` to ensure security.
  * **Task Management**: A full **CRUD** (Create, Read, Update, Delete) API for managing tasks. Each task is associated with a specific user.
  * **Filtering & Sorting**: Tasks can be filtered by `priority` and `completion` status.
  * **Email Notifications**: Users receive an **automated email notification** when a new task is created and when a task is marked as completed. These emails are sent in the background using FastAPI's `BackgroundTasks` to avoid blocking the main application thread.
  * **CORS**: The API is configured with **CORS** middleware, allowing it to be integrated with different front-end applications.
  * **Dependency Injection**: The application uses FastAPI's dependency injection system for managing database sessions and handling user authentication.

-----

#### Prerequisites

  * **Python 3.8+**
  * **pip** (Python package installer)
  * **An Email Account**: A Gmail account with **App Passwords** enabled is recommended for sending notifications.
  * **Environment Variables**: You must set up a `.env` file for sensitive information.

-----

#### Setup and Installation

1.  **Clone the Repository**:

    ```bash
    git clone https://github.com/your-repo/task-manager-api.git
    cd task-manager-api
    ```

2.  **Create a Python virtual environment**:

    ```bash
    python -m venv venv
    ```

3.  **Activate the virtual environment**:

      * On Windows:
        ```bash
        venv\Scripts\activate
        ```
      * On macOS/Linux:
        ```bash
        source venv/bin/activate
        ```

4.  **Install the required dependencies**:

    ```bash
    pip install fastapi "uvicorn[standard]" sqlalchemy python-jose[cryptography] passlib[bcrypt] python-dotenv
    ```

5.  **Create a `.env` file**:
    Create a file named `.env` in the project root and add the following variables. Replace the placeholder values with your actual credentials.

    ```env
    SECRET_KEY="a_secure_random_key_here"
    EMAIL_HOST="smtp.gmail.com"
    EMAIL_PORT=587
    EMAIL_USERNAME="your-email@gmail.com"
    EMAIL_PASSWORD="your_app_password"
    EMAIL_FROM="your-email@gmail.com"
    ```

      * **Note**: For `EMAIL_PASSWORD`, you should use an **App Password** from your Google account settings, not your primary password.

6.  **Run the application**:

    ```bash
    uvicorn main:app --reload
    ```

    The `--reload` flag is useful for development as it automatically restarts the server on code changes.

-----

#### API Endpoints

The API documentation is automatically generated by FastAPI and can be accessed at:

  * **Swagger UI**: `http://127.0.0.1:8000/docs`
  * **ReDoc**: `http://127.0.0.1:8000/redoc`

#### Authentication Endpoints

  * `POST /users/`

      * **Description**: Register a new user.
      * **Request Body**: `{"email": "string", "name": "string", "password": "string"}`
      * **Response**: Returns the created user object.

  * `POST /token`

      * **Description**: Authenticate a user and get an access token.
      * **Request Body**: `{"username": "user_email", "password": "user_password"}` (as form data)
      * **Response**: Returns a JWT access token and token type.

  * `GET /users/me/`

      * **Description**: Get the current authenticated user's details.
      * **Requires**: `Authorization: Bearer <token>` header.

#### Task Endpoints

  * `POST /tasks/`

      * **Description**: Create a new task for the authenticated user.
      * **Requires**: `Authorization: Bearer <token>`.
      * **Request Body**: `{"title": "string", "description": "string", "due_date": "datetime", "priority": "string"}`.
      * **Notification**: Triggers an email notification to the user.

  * `GET /tasks/`

      * **Description**: Retrieve a list of tasks for the authenticated user. Supports optional query parameters for filtering.
      * **Requires**: `Authorization: Bearer <token>`.
      * **Query Parameters**: `skip`, `limit`, `priority`, `completed`.

  * `GET /tasks/{task_id}`

      * **Description**: Retrieve a single task by its ID.
      * **Requires**: `Authorization: Bearer <token>`.

  * `PUT /tasks/{task_id}`

      * **Description**: Update an existing task.
      * **Requires**: `Authorization: Bearer <token>`.
      * **Request Body**: `{"title": "string", "description": "string", "due_date": "datetime", "priority": "string", "completed": "boolean"}` (fields are optional).
      * **Notification**: Triggers an email if the task's `completed` status changes from `False` to `True`.

  * `DELETE /tasks/{task_id}`

      * **Description**: Delete a task.
      * **Requires**: `Authorization: Bearer <token>`.